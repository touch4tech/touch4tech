<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="./theme/img/favicon.ico" />
        <title>Touch 4 Tech</title>
        <meta name="author" content="Rezpe & Oberron" />
        <meta name="description" content="One brick at a time contributing to the DKIW pyramid fundation" />
        <meta name="keywords" content="home IT admin, IT, sante, paperasse, web" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
        <meta content="" property="fb:app_id">
        <meta content="Touch 4 Tech" property="og:site_name">
        <base href=".">
        
        <meta content="Touch 4 Tech" property="og:title">
        <meta content="website" property="og:type">
        <meta content="One brick at a time contributing to the DKIW pyramid fundation" property="og:description">
        <meta content="/" property="og:url">
        <meta content="./theme/img/site_logo.png" property="og:image">
        
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@touch4tech">
        <meta name="twitter:creator" content="@touch4tech">
        <meta name="twitter:title" content="Touch 4 Tech">
        <meta name="twitter:url" content=".">
        <meta name="twitter:description" content="One brick at a time contributing to the DKIW pyramid fundation">
        <!-- Font awesome icons -->
        <script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
        <!-- Font awesome icons -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="./theme/css/syntax.css">
        <!-- Bootstrap core CSS -->
        <link href="./theme/css/bootstrap.min.css" rel="stylesheet">
        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="./theme/css/super-search.css">
        <link rel="stylesheet" href="./theme/css/thickbox.css">
        <link rel="stylesheet" href="./theme/css/projects.css">
        <link rel="stylesheet" href="./theme/css/main.css">
        <style>
        pre { background-color: #93a1a1 !important;}
        </style>
    </head>
  <body>
      <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href=""><img class="profile-avatar" src="./theme/img/site_logo.png" height="75px" width="75px" /></a>
          <h1 class="site-name">Touch 4 Tech</h1>
          
            <div class="profile-about">One brick at a time contributing to the DKIW pyramid fundation</div>
          
          <div class="social">
            <ul class="icons">
            <li class="icon brands fa fa-twitter"><a href="https://twitter.com/touch4tech" ><span class="label_no">Twitter</span></a></li>
            <li class="icon brands fa fa-youtube"><a href="https://www.youtube.com/@touch4techdev" ><span class="label_no">Youtube</span></a></li>
            <li class="icon brands fa fa-tiktok"><a href="https://www.tiktok.com/@touch4tech.dev" ><span class="label_no">tiktok</span></a></li>
            <li class="icon brands fa fa-facebook-f"><a href="https://www.facebook.com/touch4tech.dev" ><span class="label_no">Facebook</span></a></li>
            <li class="icon brands fa fa-github"><a href="https://github.com/touch4tech/touch4tech" ><span class="label_no">GitHub</span></a></li>
            <li class="icon brands fa fa-podcast"><a href="https://feeds.soundcloud.com/users/soundcloud:users:404637861/sounds.rss" ><span class="label_no">Podcast</span></a></li>
            <li class="icon brands fa fa-instagram"><a href="https://www.instagram.com/touch4techdev/" ><span class="label_no">Instagram</span></a></li>
            <li class="icon brands fa fa-rss"><a href="https://touch4tech.dev/feed.xml" ><span class="label_no">RSS</span></a></li>
            <li class="icon brands fa fa-envelope"><a href="mailto:tellme@touch4tech.dev" ><span class="label_no">Mail</span></a></li>
          </ul>
          </div>
          
          <div class="search" id="js-search">
            <input type="text" placeholder="(sitemap)~$ type to search" class="search__input form-control" id="js-search__input">
            <ul class="search__results" id="js-search__results"></ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="/">Home</a></li>
            <li><a class="about" href="pages/contact.html">Contact</a></li>
            <li><a class="about" href="pages/credits.html">Credits</a></li>
            <li><a class="about" href="pages/about.html">About</a></li>
            <li><a class="about" href="pages/authors.html">Authors</a></li>
            <li><a class="about" href=".feed.xml">XML Feed</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">

  <h1>notion2md</h1>
<p>categories: <a href="./category/misc.html">misc</a> </p>  Authors:  <a href="./author/oberron.html">Oberron</a> ,  <a href="./author/rezpe.html">Rezpe</a> ,  <a href="./author/rezpe-oberron.html">Rezpe & Oberron</a> ,  <a href="./author/sebas.html">sebas</a> ,   <br>
  <hr>

   <h1>Notion to .md</h1>
<ol>
<li>a simple <a href="https://gist.github.com/oberron/28939ddb1fd4ea4721475cf2edf474e8">gist</a> to convert notion pages to markdown</li>
</ol>
<p>https://gist.github.com/oberron/28939ddb1fd4ea4721475cf2edf474e8</p>
<ol>
<li>a simple github action clones the gist and uses it to create markdown files</li>
</ol>
<p>source: touch4tech/.github/workflows/notion2pelican.yml</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notion2Pelican</span>
<span class="c1"># Controls when the workflow will run</span>
<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Allows you to run this workflow manually from the Actions tab</span>
<span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span>
<span class="c1"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>
<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># This workflow contains a single job called &quot;build&quot;</span>
<span class="w">  </span><span class="nt">sync_notion</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># The type of runner that the job will run on</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="c1"># Steps represent a sequence of tasks that will be executed as part of the job</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">env</span><span class="w">  </span><span class="c1"># THIS WAS MISSING</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout website source</span>
<span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">checkout-master</span>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">setup notion key</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="c1"># Or as an environment variable</span>
<span class="w">          </span><span class="nt">NOTIONKEY</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.NOTIONKEY }}</span>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python importnotion.py</span>
</code></pre></div>

<p>a wrapper file importnotion.py</p>
<p>touch4tech/importnotion.py</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>

<span class="n">gist</span> <span class="o">=</span> <span class="s2">&quot;28939ddb1fd4ea4721475cf2edf474e8&quot;</span>
<span class="n">gist_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://gist.github.com/</span><span class="si">{</span><span class="n">gist</span><span class="si">}</span><span class="s2">.git&quot;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s2">&quot;git&quot;</span><span class="p">,</span> <span class="s2">&quot;clone&quot;</span><span class="p">,</span> <span class="n">gist_url</span><span class="p">])</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gist error code: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s2">&quot;mv&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gist</span><span class="si">}</span><span class="s2">/notion2md.py&quot;</span><span class="p">,</span><span class="s2">&quot;./notion2md.py&quot;</span><span class="p">])</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mv error code: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">notion2md</span> <span class="kn">import</span> <span class="n">readDatabase</span><span class="p">,</span> <span class="n">process_page_results</span>
<span class="kn">from</span> <span class="nn">notion2md</span> <span class="kn">import</span> <span class="n">get_notion_headers</span><span class="p">,</span> <span class="n">pageid_2_md</span>

<span class="c1"># notion db id for touch4tech.dev is:</span>
<span class="n">FT_dbid</span> <span class="o">=</span> <span class="s1">&#39;af9dd2942ef74d7c9faf32e694055a7e&#39;</span>
<span class="c1"># get the GitHub secret which has the Notion Key</span>
<span class="n">my_secret</span> <span class="o">=</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NOTIONKEY&quot;</span><span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">get_notion_headers</span><span class="p">(</span><span class="n">my_secret</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;headers&quot;</span><span class="p">,</span><span class="n">headers</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">readDatabase</span><span class="p">(</span><span class="n">databaseId</span><span class="o">=</span><span class="n">FT_dbid</span><span class="p">,</span> <span class="n">notion_headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">process_page_results</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>

<span class="n">res_t</span> <span class="o">=</span> <span class="n">readDatabase</span><span class="p">(</span><span class="n">databaseId</span><span class="o">=</span><span class="n">res2</span><span class="p">[</span><span class="s2">&quot;page_children_ids&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">notion_headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">md</span> <span class="o">=</span> <span class="n">pageid_2_md</span><span class="p">(</span><span class="n">res_t</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>
</code></pre></div>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./theme/js/jquery.min.js"></script>
    <script src="./theme/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="./theme/js/bootstrap.min.js"></script>
    <script src="./theme/js/super-search.js"></script>
    <script src="./theme/js/thickbox-compressed.js"></script>
    <script src="./theme/js/projects.js"></script>
    <script type="text/x-mathjax-config">
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
          fontCache: 'global'
        }
      };
</script>
<!-- mathjax 2.7.5 latest.js -->
<script type="text/javascript" async
  src="./theme/js/tex-svg.js">
</script>
  </body>
</html>